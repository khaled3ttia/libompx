\hypertarget{vec_add_8cpp-example}{}\doxysection{vec\+\_\+add.\+cpp}
Simple Integer Vector Addition example that uses the Accessor header ~\newline



\begin{DoxyCodeInclude}{0}
\DoxyCodeLine{\textcolor{comment}{//=== vec\_add.cpp -\/ Vector Addition using Accessor Example -\/-\/-\/-\/*-\/ C++ -\/*-\/===//}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{// Part of the libompx Project, under the MIT License.}}
\DoxyCodeLine{\textcolor{comment}{// See libompx/LICENSE.txt for license information}}
\DoxyCodeLine{\textcolor{comment}{//}}
\DoxyCodeLine{\textcolor{comment}{//===-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/===//}}
\DoxyCodeLine{\textcolor{comment}{}\textcolor{comment}{//===-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/===//}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <iostream>}}
\DoxyCodeLine{\textcolor{preprocessor}{\#include <omp.h>}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include "{}utils.h"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{Accessor_8h}{Accessor.h}}"{}}}
\DoxyCodeLine{}
\DoxyCodeLine{constexpr \textcolor{keywordtype}{int} NROWS = 1;}
\DoxyCodeLine{constexpr \textcolor{keywordtype}{int} NCOLS = 10;}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keyword}{using namespace }\mbox{\hyperlink{namespacelibompx}{libompx}};}
\DoxyCodeLine{}
\DoxyCodeLine{\textcolor{keywordtype}{int} main() \{}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordtype}{int} *a = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[NROWS * NCOLS];}
\DoxyCodeLine{  \textcolor{keywordtype}{int} *b = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[NROWS * NCOLS];}
\DoxyCodeLine{  \textcolor{keywordtype}{int} *c = \textcolor{keyword}{new} \textcolor{keywordtype}{int}[NROWS * NCOLS];}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Populate a}}
\DoxyCodeLine{  generateIntMatrix(a, NROWS, NCOLS, 0.7);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Print a}}
\DoxyCodeLine{  std::cout << \textcolor{stringliteral}{"{}A: "{}};}
\DoxyCodeLine{  printVector(a, 0, NROWS * NCOLS);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Populate b}}
\DoxyCodeLine{  generateIntMatrix(b, NROWS, NCOLS, 0.5);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Print b}}
\DoxyCodeLine{  std::cout << \textcolor{stringliteral}{"{}B: "{}};}
\DoxyCodeLine{  printVector(b, 0, NROWS * NCOLS);}
\DoxyCodeLine{}
\DoxyCodeLine{  Accessor<READ, int> acc\_a(a, NROWS * NCOLS);}
\DoxyCodeLine{  Accessor<READ, int> acc\_b(b, NROWS * NCOLS);}
\DoxyCodeLine{  Accessor<WRITE, int> acc\_c(c, NROWS * NCOLS);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Offload the addition to target device}}
\DoxyCodeLine{\textcolor{preprocessor}{\#pragma omp target teams distribute parallel for}}
\DoxyCodeLine{  \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < NROWS * NCOLS; i++) \{}
\DoxyCodeLine{    \textcolor{comment}{// operate on previously defined accessors}}
\DoxyCodeLine{    acc\_c[i] = acc\_a[i] + acc\_b[i];}
\DoxyCodeLine{  \}}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// Print c to ensure results are correct after computing}}
\DoxyCodeLine{  std::cout << \textcolor{stringliteral}{"{}After device:"{}} << std::endl;}
\DoxyCodeLine{  std::cout << \textcolor{stringliteral}{"{}C: "{}};}
\DoxyCodeLine{  printVector(c, 0, NROWS * NCOLS);}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{comment}{// free dynamically allocated memory regions}}
\DoxyCodeLine{  \textcolor{keyword}{delete}[] a;}
\DoxyCodeLine{  \textcolor{keyword}{delete}[] b;}
\DoxyCodeLine{  \textcolor{keyword}{delete}[] c;}
\DoxyCodeLine{}
\DoxyCodeLine{  \textcolor{keywordflow}{return} 0;}
\DoxyCodeLine{\}}
\DoxyCodeLine{}

\end{DoxyCodeInclude}
 